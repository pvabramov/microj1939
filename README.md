Проект реализации протокола SAE J1939
=====================================

Протокол J1939 - стандарт коммуникационной и диагностической сети для различных машин.
Изначально был разработан в США для грузовиков. Данный стандарт является коммерческой разработкой,
поэтому мало распространён. Сеть, созданная на основе J1939, в качестве канального
уровня использует коммуникационную шину CAN стандарта CAN 2.0b. Используются только
расширенные идентификаторы (29 бит). В настоящее время находит широкое применение в
сельскохозяйственной технике, автобусах, грузовых автомобилях.

Дерево проекта
--------------

 - J1939   - каталог с заголовочными файлами для включения в проект;
 - src     - каталог с исходными текстами протокола;
 - samples - примеры использования.

Использование
-------------

Протокол реализован на языке Си и распространяется в виде исходных текстов для
включения в другие проекты. Для этого необходимо скопировать каталог J1939 в
корень пути поиска заголовочных файлов, а ".c" файлы из каталога src добавить
в сборку проекта.

Также для сборки проекта требуется реализовать BSP функции, которые объявлены
в <J1939/j1939_bsp.h>:

 - j1939_bsp_lock()     - функция синхронизации для блокирования процесса;
 - j1939_bsp_unlock()   - функция синхронизации для разблокировки процесса;
 - j1939_bsp_get_time() - функция получения времени в мс;
 - j1939_bsp_mdelay()   - функция задержки в мс;
 - j1939_bsp_CAN_send() - функция отправки данных по CAN.

Для работы протокола необходимо выполнить следующие условия:

 - проинициализировать CAN интерфейс;
 - проинициализировать библиотеку протокола J1939 (j1939_initialize(), j1939_configure());
 - по получению данных от CAN вызывать функцию j1939_handle_receiving();
 - [не обязательно] при необходимости по событию отправки данных в шину можно вызывать j1939_handle_transmiting()
   для доотправки данных, например, после освобождения буфера отправки в контроллере CAN;
 - настроить адрес устройства на шине (j1939_claim_address);
 - периодически вызывать функцию j1939_process() для работы протокола.
